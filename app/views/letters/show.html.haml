.row
  .span8
    .letters
      %ul.breadcrumb.letters{ style: "display: flex; padding: 20px" }
        %li
          .voteCount.pull-left
            %div{class: "countNumber #{@letter.id}"}
              = @letter.likes.count
            - if user_signed_in?
              = link_to 'UpVote', '#', class: "btn likeButton #{@letter.like_by?(current_user) ? 'disabled' : ''}", data: {url: like_letter_path(@letter)}
            - else
              = link_to 'UpVote', '#', class: 'btn', rel: 'popover', data: {content: "You need to login first to Like it. ", title: 'Oops !!'}
          .personalInfo.pull-right
            .pull-right.names
              = @letter.user.external_identities.order(updated_at: :desc).first.name
              %br
              %strong
                -if @letter.user.external_identities.where(provider: 'twitter').exists?
                  - twitter_identity = @letter.user.external_identities.find_by(provider: 'twitter')
                  %a{ href: "https://www.twitter.com/#{twitter_identity.handle}", target: "_blank" }
                    %img{ src: asset_path('twitter.png'), alt: "Twitter Logo", width: "24" } 
                    = "@#{twitter_identity.handle}"
                  %br  
              %strong
                -if @letter.user.external_identities.where(provider: 'github').exists?
                  - github_identity = @letter.user.external_identities.find_by(provider: 'github')
                  %a{ href: "https://www.github.com/#{github_identity.handle}", target: "_blank" }
                    %img{ src: asset_path('github-logo.png'), alt: "GitHub Logo", width: "24" } 
                    = "@#{github_identity.handle}"
              %br
              %small.timeAgo
                = link_to letter_path(@letter) do
                  = time_ago_in_words @letter.created_at
                  ago
            .pull-right.thumbnail.imageWrapper{ style: 'max-height: 50px; max-width: 50px' }
              = get_twitter_image(@letter.user)
      = markdown(@letter.description)
      %br
      %div
        %div.pull-left
          - if @letter.user.external_identities.where(provider: 'github').exists?
            - github_identity = @letter.user.external_identities.find_by(provider: 'github')
            - github_url = "https://www.github.com/#{github_identity.handle}"
            %a.twitter-share-button{"data-size": "large", "data-hashtags": "whyloveruby", href: "https://twitter.com/share", class: 'pull-right', "data-text": "Here is (#{github_url})'s'  reason to love Ruby. -  #{letter_url(@letter)}\n Tell us yours at"}
          .clr
          -if @letter.user.external_identities.where(provider: 'twitter').exists?
            - twitter_identity = @letter.user.external_identities.find_by(provider: 'twitter')
            %a.twitter-share-button{"data-size": "large", "data-hashtags": "whyloveruby",
                   href: "https://twitter.com/share", class: 'pull-right',
                   "data-text": "Here is @#{twitter_identity.handle}\'s reason to love Ruby. -  #{letter_url(@letter)}\n Tell us yours at"}
        .clr
        :javascript
                 !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
        .letterActions.pull-right
          - if user_signed_in?
            - if(current_user.id.to_i == @letter.user_id.to_i)
              = link_to "Edit", edit_letter_path(@letter)
              |
              = link_to "Delete", letter_path(@letter),
               method: :delete,
               data: {confirm: "Are you sure?"}
      %br
      %hr
